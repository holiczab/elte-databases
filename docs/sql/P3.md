<img src="image.png" alt="alt text" width="700" />

# 
<img src="image-1.png" alt="alt text" width="700" />

# Single-Row Functions

- Manipulate data items
- Accept arguments and return one value
- Act on each row that is returned
- Return one result per row
- May modify the data type
- Can be nested
- Accept arguments that can be a column or an expression

# function_name [(arg1, arg2,...)]

<img src="image-3.png" alt="alt text" width="700" />

# 
<img src="image-4.png" alt="alt text" width="700" />

# 
<img src="image-5.png" alt="alt text" width="700" />

# Using Case-Manipulation Functions

Display the employee number, name, and department number for employee Higgins:

```sql
SELECT employee_id, last_name, department_id
FROM nikovits.employees
WHERE last_name = 'higgins';
```

| EMPLOYEE_ID | LAST_NAME | DEPARTMENT_ID |
|-------------|-----------|---------------|

```sql
SELECT employee_id, last_name, department_id
FROM nikovits.employees
WHERE LOWER(last_name) = 'higgins';
```

| EMPLOYEE_ID | LAST_NAME | DEPARTMENT_ID |
|-------------|-----------|---------------|
| 205         | Higgins   | 110           |

# 
<img src="image-6.png" alt="alt text" width="700" />

# 
<img src="image-7.png" alt="alt text" width="700" />

# 
<img src="image-8.png" alt="alt text" width="700" />

# 
<img src="image-9.png" alt="alt text" width="700" />

# 
<img src="image-10.png" alt="alt text" width="700" />

# Using the MOD Function

For all nikovits.employees with job title of Sales Representative, calculate the remainder of the salary after it is divided by 5,000.

```sql
SELECT last_name, salary, MOD(salary, 5000)
FROM nikovits.employees
WHERE job_id = 'SA_REP';
```

| LAST_NAME  | SALARY | MOD(SALARY,5000) |
|------------|--------|------------------|
| Tucker     | 10000  | 0                |
| Bernstein  | 9500   | 4500             |
| Hall       | 9000   | 4000             |
| Olsen      | 8000   | 3000             |
| Cambrault  | 7500   | 2500             |
| Tuvault    | 7000   | 2000             |
| King       | 10000  | 0                |

# Working with Dates

- The Oracle database stores dates in an internal numeric format: century, year, month, day, hours, minutes, and seconds.
- The default date display format is DD-MON-YY. (DD-MON-RR)
    - Enables you to store 21st-century dates in the 20th century by specifying only the last two digits of the year
    - Enables you to store 20th-century dates in the 21st century in the same way

```sql
SELECT last_name, hire_date
FROM nikovits.employees
WHERE hire_date < '01-FEB-88';
```

| LAST_NAME | HIRE_DATE |
|-----------|-----------|
| King      | 17/06/87  |
| Whalen    | 17/09/87  |

# SYSDATE is a function that returns:

- Date
- Time

# Arithmetic with Dates

- Add or subtract a number to or from a date for a resultant date value.
- Subtract two dates to find the number of days between those dates.
- Add hours to a date by dividing the number of hours by 24.

```sql
SELECT last_name, (SYSDATE-hire_date)/7 AS WEEKS
FROM nikovits.employees
WHERE department_id = 90;
```

| LAST_NAME | WEEKS                |
|-----------|----------------------|
| King      | 1995.593908730158730 |
| Kochhar   | 1877.451051587301587 |
| De Haan   | 1704.593908730158730 |

# 
<img src="image-11.png" alt="alt text" width="700" />

# 
<img src="image-12.png" alt="alt text" width="700" />

# 
<img src="image-13.png" alt="alt text" width="700" />

# 
<img src="image-14.png" alt="alt text" width="700" />

# 
<img src="image-15.png" alt="alt text" width="700" />

# 
<img src="image-16.png" alt="alt text" width="700" />

# 
<img src="image-17.png" alt="alt text" width="700" />

# Using the TO_CHAR Function with Dates

# TO_CHAR(date, 'format_model')

The format model:

- Must be enclosed by single quotation marks
- Is case-sensitive
- Can include any valid date format element
- Has an fm element to remove padded blanks or suppress leading zeros
- Is separated from the date value by a comma TO_CHAR(date, 'format_model')

# 
<img src="image-18.png" alt="alt text" width="700" />

#
<img src="image-19.png" alt="alt text" width="700" />

# Using the TO_CHAR Function with Dates

```sql
SELECT last_name,
    TO_CHAR(hire_date, 'fmDD Month YYYY')
    AS HIREDATE
FROM nikovits.employees;
```

| LAST_NAME   | HIREDATE          |
|-------------|-------------------|
| King        | 17 June 1987      |
| Kochhar     | 21 September 1989 |
| De Haan     | 13 January 1993   |
| Hunold      | 3 January 1990    |
| Ernst       | 21 May 1991       |
| Austin      | 25 June 1997      |
| Pataballa   | 5 February 1998   |
| Lorentz     | 7 February 1999   |

<img src="image-20.png" alt="alt text" width="700" />

# Using the TO_CHAR Function with Numbers

```sql
SELECT TO_CHAR(salary, '$99,999.00') SALARY
FROM nikovits.employees
WHERE last_name = 'Ernst';
```

| SALARY     |
|------------|
| $6,000.00  |

# 
<img src="image-21.png" alt="alt text" width="700" />

#
<img src="image-22.png" alt="alt text" width="700" />

# Nesting Functions

```sql
SELECT last_name,
    UPPER(CONCAT(SUBSTR (LAST_NAME, 1, 8), '_US'))
FROM nikovits.employees
WHERE department_id = 60;
```

| LAST_NAME  | UPPER(CONCAT(SUBSTR(LAST_NAME,1,8),'_US')) |
|------------|--------------------------------------------|
| Hunold     | HUNOLD_US                                  |
| Ernst      | ERNST_US                                   |
| Austin     | AUSTIN_US                                  |
| Pataballa  | PATABALL_US                                |
| Lorentz    | LORENTZ_US                                 |

# 
<img src="image-23.png" alt="alt text" width="700" />

# 
<img src="image-24.png" alt="alt text" width="700" />

# 
<img src="image-25.png" alt="alt text" width="700" />

# 
<img src="image-26.png" alt="alt text" width="700" />

# 
<img src="image-27.png" alt="alt text" width="700" />

# Using the COALESCE Function

- The advantage of the COALESCE function over the NVL function is that the COALESCE function can take multiple alternate values.
- If the first expression is not null, the COALESCE function returns that expression; otherwise, it does a COALESCE of the remaining expressions.

```sql
SELECT last_name,
    COALESCE(manager_id,commission_pct, -1) comm
FROM nikovits.employees
ORDER BY commission_pct;
```

| LAST_NAME | COMM |
|-----------|------|
| Lee       | 147  |
| Johnson   | 149  |
| Marvins   | 147  |
| Banda     | 147  |
| Kumar     | 148  |
| Ande      | 147  |
| Greene    | 147  |
| Grant     | 149  |
| Tuvault   | 145  |
| Bates     | 148  |

# Conditional Expressions

- Provide the use of IF-THEN-ELSE logic within a SQL statement
- Use two methods:
    - CASE expression
    - DECODE function

# 
<img src="image-29.png" alt="alt text" width="700" />

# IF THEN ELSE statement:

```sql
SELECT last_name, job_id, salary,
    CASE job_id WHEN 'IT_PROG' THEN 1.10*salary
                WHEN 'ST_CLERK' THEN 1.15*salary
                WHEN 'SA_REP' THEN 1.20*salary
    ELSE salary END "REVISED_SALARY"
FROM nikovits.employees;
```

| LAST_NAME   | JOB_ID  | SALARY | REVISED_SALARY |
|-------------|---------|--------|----------------|
| King        | AD_PRES | 24000  | 24000          |
| Kochhar     | AD_VP   | 17000  | 17000          |
| De Haan     | AD_VP   | 17000  | 17000          |
| Hunold      | IT_PROG | 9000   | 9900           |
| Ernst       | IT_PROG | 6000   | 6600           |
| Austin      | IT_PROG | 4800   | 5280           |
| Pataballa   | IT_PROG | 4800   | 5280           |

<img src="image-30.png" alt="alt text" width="700" />

```sql
SELECT last_name, job_id, salary,
    DECODE(job_id, 'IT_PROG', 1.10*salary,
            'ST_CLERK', 1.15*salary,
            'SA_REP', 1.20*salary,
            salary)
    REVISED_SALARY
FROM nikovits.employees;
```

| LAST_NAME   | JOB_ID  | SALARY | REVISED_SALARY |
|-------------|---------|--------|----------------|
| King        | AD_PRES | 24000  | 24000          |
| Kochhar     | AD_VP   | 17000  | 17000          |
| De Haan     | AD_VP   | 17000  | 17000          |
| Hunold      | IT_PROG | 9000   | 9900           |
| Ernst       | IT_PROG | 6000   | 6600           |
| Austin      | IT_PROG | 4800   | 5280           |
| Pataballa   | IT_PROG | 4800   | 5280           |

# Display the applicable tax rate for each employee in department 80:

```sql
SELECT last_name, salary,
        DECODE (TRUNC(salary/2000, 0),
                            0, 0.00,
                            1, 0.09,
                            2, 0.20,
                            3, 0.30,
                            4, 0.40,
                            5, 0.42,
                            6, 0.44,
                            0.45) TAX_RATE
FROM nikovits.employees
WHERE department_id = 80;
```

| LAST_NAME   | SALARY | TAX_RATE |
|-------------|--------|----------|
| Russell     | 14000  | .45      |
| Partners    | 13500  | .44      |
| Errazuriz   | 12000  | .44      |
| Cambrault   | 11000  | .42      |
| Zlotkey     | 10500  | .42      |
| Tucker      | 10000  | .42      |
| Bernstein   | 9500   | .4       |
| Hall        | 9000   | .4       |
| Olsen       | 8000   | .4       |

# 
<img src="image-31.png" alt="alt text" width="700" />

# 
<img src="image-32.png" alt="alt text" width="700" />

# 
<img src="image-33.png" alt="alt text" width="700" />

# Using the AVG and SUM Functions

```sql
SELECT AVG(salary), MAX(salary),
        MIN(salary), SUM(salary)
        FROM nikovits.employees
WHERE job_id LIKE '%REP%';
```

| AVG(SALARY)         | MAX(SALARY) | MIN(SALARY) | SUM(SALARY) |
|---------------------|-------------|-------------|-------------|
| 8272.727272727272727 | 11500       | 6000        | 273000      |

# Using the MIN and MAX Functions

```sql
SELECT MIN(hire_date), MAX(hire_date)
FROM nikovits.employees;
```

| MIN(HIRE_DATE) | MAX(HIRE_DATE) |
|---------------|----------------|
| 17/06/87      | 21/04/00       |

# Using the COUNT Function

# COUNT(*) returns the number of rows in a table:

```sql
SELECT COUNT(*)
FROM nikovits.employees
WHERE department_id = 50;
```

| COUNT(*) |
|----------|
| 45       |

# COUNT(expr) returns the number of rows with non-null values for expr:

```sql
SELECT COUNT(commission_pct)
FROM nikovits.employees
WHERE department_id = 80
```

| COUNT(COMMISSION_PCT) |
|-----------------------|
| 34                    |

# Using the DISTINCT Keyword

- COUNT(DISTINCT expr) returns the number of distinct non-null values of the expr.
- To display the number of distinct department values in the nikovits.employees table:

```sql
SELECT COUNT(DISTINCT department_id)
FROM nikovits.employees;
```

| COUNT(DISTINCT DEPARTMENT_ID) |
|-------------------------------|
| 11                            |

# Group Functions and Null Values

# Group functions ignore null values in the column:

```sql
SELECT AVG(commission_pct)
FROM nikovits.employees;
```

| AVG(COMMISSION_PCT)  |
|----------------------|
| .2228571428571428571 |

# The NVL function forces group functions to include null values:

```sql
SELECT AVG(NVL(commission_pct, 0))
FROM nikovits.employees;
```

| AVG(NVL(COMMISSION_PCT,0))          |
|-------------------------------------|
| .0728971962616822429906542          |