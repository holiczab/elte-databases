<img src="image.png" alt="alt text" width="700" />

#

<img src="image-1.png" alt="alt text" width="700" />


# Using the GROUP BY Clause

All columns in the SELECT list that are not in group functions must be in the GROUP BY clause.

SELECT department_id, AVG(salary)
FROM nikovits.employees
GROUP BY department_id;

<pre>
+----------------------+----------------------+
| DEPARTMENT_ID        | AVG(SALARY)          |
+----------------------+----------------------+
| 100                  | 8600                 |
| 30                   | 4150                 |
| NULL                 | 7000                 |
| 90                   | 19333.33333333333333 |
| 20                   | 9500                 |
| 70                   | 10000                |
| 110                  | 10150                |
| 50                   | 3475.555555555555555 |
| 80                   | 8955.882352941176470 |
| 40                   | 6500                 |
| 60                   | 5760                 |
| 10                   | 4400                 |
+----------------------+----------------------+
</pre>

# Using the GROUP BY Clause

The GROUP BY column does not have to be in the SELECT list.

SELECT AVG(salary)
FROM nikovits.employees
GROUP BY department_id;

<pre>
+----------------------+
| AVG(SALARY)          |
+----------------------+
| 8600                 |
| 4150                 |
| 7000                 |
| 19333.33333333333333 |
| 9500                 |
| 10000                |
| 10150                |
| 3475.555555555555555 |
| 8955.882352941176470 |
| 6500                 |
| 5760                 |
| 4400                 |
+----------------------+
</pre>

<img src="image-2.png" alt="alt text" width="700" />

# Using the GROUP BY Clause on Multiple Columns

SELECT department_id dept_id, job_id, SUM(salary)
FROM nikovits.employees
GROUP BY department_id, job_id ;

<pre>
+----------------------+----------------------+----------------------+
| DEPT_ID              | JOB_ID               | SUM(SALARY)          |
+----------------------+----------------------+----------------------+
| 110                  | AC_ACCOUNT           | 8300                 |
| 90                   | AD_VP                | 34000                |
| 50                   | ST_CLERK             | 55700                |
| 80                   | SA_REP               | 243500               |
| 50                   | ST_MAN               | 36400                |
| 80                   | SA_MAN               | 61000                |
| 110                  | AC_MGR               | 12000                |
| 90                   | AD_PRES              | 24000                |
| 60                   | IT_PROG              | 28800                |
| 100                  | FI_MGR               | 12000                |
| 30                   | PU_CLERK             | 13900                |
| 50                   | SH_CLERK             | 64300                |
| 20                   | MK_MAN               | 13000                |
| 100                  | FI_ACCOUNT           | 39600                |
| NULL                 | SA_REP               | 7000                 |
| 70                   | PR_REP               | 10000                |
| 30                   | PU_MAN               | 11000                |
| 10                   | AD_ASST              | 4400                 |
| 20                   | MK_REP               | 6000                 |
| 40                   | HR_REP               | 6500                 |
+----------------------+----------------------+----------------------+
</pre>

<img src="image-3.png" alt="alt text" width="700" />

#

<img src="image-4.png" alt="alt text" width="700" />

#

<img src="image-5.png" alt="alt text" width="700" />

#

<img src="image-6.png" alt="alt text" width="700" />

# Using the HAVING Clause

SELECT department_id, MAX(salary)
FROM nikovits.employees
GROUP BY department_id
HAVING MAX(salary)>10000 ;

<pre>
+----------------------+----------------------+
| DEPARTMENT_ID        | MAX(SALARY)          |
+----------------------+----------------------+
| 100                  | 12000                |
| 30                   | 11000                |
| 90                   | 24000                |
| 20                   | 13000                |
| 110                  | 12000                |
| 80                   | 14000                |
+----------------------+----------------------+
</pre>

SELECT job_id, SUM(salary) PAYROLL
FROM nikovits.employees
WHERE job_id NOT LIKE '%REP%'
GROUP BY job_id
HAVING SUM(salary) > 13000
ORDER BY SUM(salary);

<pre>
+----------------------+----------------------+
| JOB_ID               | PAYROLL              |
+----------------------+----------------------+
| PU_CLERK             | 13900                |
| AD_PRES              | 24000                |
| IT_PROG              | 28800                |
| AD_VP                | 34000                |
| ST_MAN               | 36400                |
| FI_ACCOUNT           | 39600                |
| ST_CLERK             | 55700                |
| SA_MAN               | 61000                |
| SH_CLERK             | 64300                |
+----------------------+----------------------+
</pre>

# Nesting Group Functions

- Display the maximum average salary:
- Group functions can be nested to a depth of two.
- The example displays the maximum average salary.

SELECT MAX(AVG(salary))
FROM nikovits.employees
GROUP BY department_id;

<pre>
+----------------------+
| MAX(AVG(SALARY))     |
+----------------------+
| 19333.33333333333333 |
+----------------------+
</pre>

<img src="image-7.png" alt="alt text" width="700" />

# Types of Joins

- Joins that are compliant with the SQL:1999 standard include the following:
    – Cross joins
    – Natural joins
    – USING clause
    – Full (or two-sided) outer joins
    – Arbitrary join conditions for outer joins

#

<img src="image-8.png" alt="alt text" width="700" />

# Creating Natural Joins

- The NATURAL JOIN clause is based on all columns in the two tables that have the same name.
- It selects rows from the two tables that have equal values in all matched columns.
- If the columns having the same names have different data types, an error is returned.

# Retrieving Records with Natural Joins

SELECT department_id, department_name,
location_id, city
FROM nikovits.departments
NATURAL JOIN nikovits.locations ;

<pre>
+----------------------+----------------------+----------------------+----------------------+
| DEPARTMENT_ID        | DEPARTMENT_NAME      | LOCATION_ID          | CITY                 |
+----------------------+----------------------+----------------------+----------------------+
| 10                   | Administration       | 1700                 | Seattle              |
| 20                   | Marketing            | 1800                 | Toronto              |
| 30                   | Purchasing           | 1700                 | Seattle              |
| 40                   | Human Resources      | 2400                 | London               |
| 50                   | Shipping             | 1500                 | South San Francisco  |
| 60                   | IT                   | 1400                 | Southlake            |
| 70                   | Public Relations     | 2700                 | Munich               |
| 80                   | Sales                | 2500                 | Oxford               |
| 90                   | Executive            | 1700                 | Seattle              |
| 100                  | Finance              | 1700                 | Seattle              |
| 110                  | Accounting           | 1700                 | Seattle              |
| 120                  | Treasury             | 1700                 | Seattle              |
| 130                  | Corporate Tax        | 1700                 | Seattle              |
| 140                  | Control And Credit   | 1700                 | Seattle              |
| 150                  | Shareholder Services | 1700                 | Seattle              |
| 160                  | Benefits             | 1700                 | Seattle              |
| 170                  | Manufacturing        | 1700                 | Seattle              |
| 180                  | Construction         | 1700                 | Seattle              |
| 190                  | Contracting          | 1700                 | Seattle              |
| 200                  | Operations           | 1700                 | Seattle              |
| 210                  | IT Support           | 1700                 | Seattle              |
| 220                  | NOC                  | 1700                 | Seattle              |
...
</pre>

# Creating Joins with the USING Clause

- If several columns have the same names but the data types do not match, the NATURAL JOIN clause can be modified with the USING clause to specify the columns that should be used for an equijoin.
- Use the USING clause to match only one column when more than one column matches.
- Do not use a table name or alias in the referenced columns.
- The NATURAL JOIN and USING clauses are mutually exclusive.

<img src="image-9.png" alt="alt text" width="700" />

SELECT nikovits.employees.employee_id, nikovits.employees.last_name,
nikovits.departments.location_id, department_id
FROM nikovits.employees JOIN nikovits.departments
USING (department_id) ;

<pre>
+----------------------+----------------------+----------------------+----------------------+
| EMPLOYEE_ID          | LAST_NAME            | LOCATION_ID          | DEPARTMENT_ID        |
+----------------------+----------------------+----------------------+----------------------+
| 100                  | King                 | 1700                 | 90                   |
| 101                  | Kochhar              | 1700                 | 90                   |
| 102                  | De Haan              | 1700                 | 90                   |
| 103                  | Hunold               | 1400                 | 60                   |
| 104                  | Ernst                | 1400                 | 60                   |
| 105                  | Austin               | 1400                 | 60                   |
| 106                  | Pataballa            | 1400                 | 60                   |
| 107                  | Lorentz              | 1400                 | 60                   |
| 108                  | Greenberg            | 1700                 | 100                  |
| 109                  | Faviet               | 1700                 | 100                  |
| 110                  | Chen                 | 1700                 | 100                  |
| 111                  | Sciarra              | 1700                 | 100                  |
| 112                  | Urman                | 1700                 | 100                  |
| 113                  | Popp                 | 1700                 | 100                  |
| 114                  | Raphaely             | 1700                 | 30                   |
| 115                  | Khoo                 | 1700                 | 30                   |
| 116                  | Baida                | 1700                 | 30                   |
| 117                  | Tobias               | 1700                 | 30                   |
| 118                  | Himuro               | 1700                 | 30                   |
| 119                  | Colmenares           | 1700                 | 30                   |
| 120                  | Weiss                | 1500                 | 50                   |
| 121                  | Fripp                | 1500                 | 50                   |
...
</pre>

# Qualifying Ambiguous

# Column Names

- Use table prefixes to qualify column names that are in multiple tables.
- Use table prefixes to improve performance.
- Use column aliases to distinguish columns that have identical names but reside in different tables.
- Do not use aliases on columns that are identified in the USING clause and listed elsewhere in the SQL statement.

<img src="image-10.png" alt="alt text" width="700" />

# Creating Joins with the ON Clause

- The join condition for the natural join is basically an equijoin of all columns with the same name.
- Use the ON clause to specify arbitrary conditions or specify columns to join.
- The join condition is separated from other search conditions.
- The ON clause makes code easy to understand.

SELECT e.employee_id, e.last_name, e.department_id,
d.department_id, d.location_id
FROM nikovits.employees e JOIN nikovits.departments d
ON (e.department_id = d.department_id);

<pre>
+----------------------+----------------------+----------------------+----------------------+----------------------+
| EMPLOYEE_ID          | LAST_NAME            | DEPARTMENT_ID        | DEPARTMENT_ID        | LOCATION_ID          |
+----------------------+----------------------+----------------------+----------------------+----------------------+
| 100                  | King                 | 90                   | 90                   | 1700                 |
| 101                  | Kochhar              | 90                   | 90                   | 1700                 |
| 102                  | De Haan              | 90                   | 90                   | 1700                 |
| 103                  | Hunold               | 60                   | 60                   | 1400                 |
| 104                  | Ernst                | 60                   | 60                   | 1400                 |
| 105                  | Austin               | 60                   | 60                   | 1400                 |
| 106                  | Pataballa            | 60                   | 60                   | 1400                 |
| 107                  | Lorentz              | 60                   | 60                   | 1400                 |
| 108                  | Greenberg            | 100                  | 100                  | 1700                 |
| 109                  | Faviet               | 100                  | 100                  | 1700                 |
| 110                  | Chen                 | 100                  | 100                  | 1700                 |
| 111                  | Sciarra              | 100                  | 100                  | 1700                 |
| 112                  | Urman                | 100                  | 100                  | 1700                 |
| 113                  | Popp                 | 100                  | 100                  | 1700                 |
| 114                  | Raphaely             | 30                   | 30                   | 1700                 |
| 115                  | Khoo                 | 30                   | 30                   | 1700                 |
| 116                  | Baida                | 30                   | 30                   | 1700                 |
| 117                  | Tobias               | 30                   | 30                   | 1700                 |
| 118                  | Himuro               | 30                   | 30                   | 1700                 |
| 119                  | Colmenares           | 30                   | 30                   | 1700                 |
| 120                  | Weiss                | 50                   | 50                   | 1500                 |
| 121                  | Fripp                | 50                   | 50                   | 1500                 |
...
</pre>

<img src="image-11.png" alt="alt text" width="700" />

SELECT e.last_name emp, m.last_name mgr
FROM nikovits.employees e JOIN nikovits.employees m
ON (e.manager_id = m.employee_id);

<pre>
+----------------------+----------------------+
| EMP                  | MGR                  |
+----------------------+----------------------+
| Kochhar              | King                 |
| De Haan              | King                 |
| Raphaely             | King                 |
| Weiss                | King                 |
| Fripp                | King                 |
| Kaufling             | King                 |
| Vollman              | King                 |
| Mourgos              | King                 |
| Russell              | King                 |
| Partners             | King                 |
| Errazuriz            | King                 |
| Cambrault            | King                 |
| Zlotkey              | King                 |
| Hartstein            | King                 |
| Greenberg            | Kochhar              |
| Whalen               | Kochhar              |
| Mavris               | Kochhar              |
| Baer                 | Kochhar              |
| Higgins              | Kochhar              |
| Hunold               | De Haan              |
| Ernst                | Hunold               |
| Austin               | Hunold               |
...
</pre>

<img src="image-12.png" alt="alt text" width="700" />

# Creating Three-Way Joins with the ON Clause

SELECT employee_id, city, department_name
FROM nikovits.employees e
JOIN nikovits.departments d
ON d.department_id = e.department_id
JOIN nikovits.locations l
ON d.location_id = l.location_id;

<pre>
+----------------------+----------------------+----------------------+
| EMPLOYEE_ID          | CITY                 | DEPARTMENT_NAME      |
+----------------------+----------------------+----------------------+
| 100                  | Seattle              | Executive            |
| 101                  | Seattle              | Executive            |
| 102                  | Seattle              | Executive            |
| 103                  | Southlake            | IT                   |
| 104                  | Southlake            | IT                   |
| 105                  | Southlake            | IT                   |
| 106                  | Southlake            | IT                   |
| 107                  | Southlake            | IT                   |
| 108                  | Seattle              | Finance              |
| 109                  | Seattle              | Finance              |
| 110                  | Seattle              | Finance              |
| 111                  | Seattle              | Finance              |
| 112                  | Seattle              | Finance              |
| 113                  | Seattle              | Finance              |
| 114                  | Seattle              | Purchasing           |
| 115                  | Seattle              | Purchasing           |
| 116                  | Seattle              | Purchasing           |
| 117                  | Seattle              | Purchasing           |
| 118                  | Seattle              | Purchasing           |
| 119                  | Seattle              | Purchasing           |
| 120                  | South San Francisco  | Shipping             |
| 121                  | South San Francisco  | Shipping             |
...
</pre>

<img src="image-13.png" alt="alt text" width="700" />

SELECT e.last_name, e.salary, j.grade_level
FROM nikovits.employees e JOIN nikovits.job_grades j
ON e.salary
BETWEEN j.lowest_sal AND j.highest_sal;

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | SALARY               | GRADE_LEVEL          |
+----------------------+----------------------+----------------------+
| Olson                | 2100                 | A                    |
| Markle               | 2200                 | A                    |
| Philtanker           | 2200                 | A                    |
| Landry               | 2400                 | A                    |
| Gee                  | 2400                 | A                    |
| Colmenares           | 2500                 | A                    |
| Marlow               | 2500                 | A                    |
| Patel                | 2500                 | A                    |
| Vargas               | 2500                 | A                    |
| Sullivan             | 2500                 | A                    |
| Perkins              | 2500                 | A                    |
| Himuro               | 2600                 | A                    |
| Matos                | 2600                 | A                    |
| OConnell             | 2600                 | A                    |
| Grant                | 2600                 | A                    |
| Mikkilineni          | 2700                 | A                    |
| Seo                  | 2700                 | A                    |
| Tobias               | 2800                 | A                    |
| Atkinson             | 2800                 | A                    |
| Geoni                | 2800                 | A                    |
| Jones                | 2800                 | A                    |
| Baida                | 2900                 | A                    |
...
</pre>

<img src="image-14.png" alt="alt text" width="700" />

#

<img src="image-15.png" alt="alt text" width="700" />

# LEFT OUTER JOIN

SELECT e.last_name, e.department_id, d.department_name
FROM nikovits.employees e LEFT OUTER JOIN nikovits.departments d
ON (e.department_id = d.department_id) ;

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | DEPARTMENT_ID        | DEPARTMENT_NAME      |
+----------------------+----------------------+----------------------+
| Whalen               | 10                   | Administration       |
| Hartstein            | 20                   | Marketing            |
| Fay                  | 20                   | Marketing            |
| Raphaely             | 30                   | Purchasing           |
| Khoo                 | 30                   | Purchasing           |
| Baida                | 30                   | Purchasing           |
| Tobias               | 30                   | Purchasing           |
| Himuro               | 30                   | Purchasing           |
| Colmenares           | 30                   | Purchasing           |
| Mavris               | 40                   | Human Resources      |
| Weiss                | 50                   | Shipping             |
| Fripp                | 50                   | Shipping             |
| Kaufling             | 50                   | Shipping             |
| Vollman              | 50                   | Shipping             |
| Mourgos              | 50                   | Shipping             |
| Nayer                | 50                   | Shipping             |
| Mikkilineni          | 50                   | Shipping             |
| Landry               | 50                   | Shipping             |
| Markle               | 50                   | Shipping             |
| Bissot               | 50                   | Shipping             |
| Atkinson             | 50                   | Shipping             |
| Marlow               | 50                   | Shipping             |
...

</pre>

# RIGHT OUTER JOIN

SELECT e.last_name, e.department_id, d.department_name
FROM nikovits.employees e RIGHT OUTER JOIN nikovits.departments d
ON (e.department_id = d.department_id) ;

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | DEPARTMENT_ID        | DEPARTMENT_NAME      |
+----------------------+----------------------+----------------------+
| King                 | 90                   | Executive            |
| Kochhar              | 90                   | Executive            |
| De Haan              | 90                   | Executive            |
| Hunold               | 60                   | IT                   |
| Ernst                | 60                   | IT                   |
| Austin               | 60                   | IT                   |
| Pataballa            | 60                   | IT                   |
| Lorentz              | 60                   | IT                   |
| Greenberg            | 100                  | Finance              |
| Faviet               | 100                  | Finance              |
| Chen                 | 100                  | Finance              |
| Sciarra              | 100                  | Finance              |
| Urman                | 100                  | Finance              |
| Popp                 | 100                  | Finance              |
| Raphaely             | 30                   | Purchasing           |
| Khoo                 | 30                   | Purchasing           |
| Baida                | 30                   | Purchasing           |
| Tobias               | 30                   | Purchasing           |
| Himuro               | 30                   | Purchasing           |
| Colmenares           | 30                   | Purchasing           |
| Weiss                | 50                   | Shipping             |
| Fripp                | 50                   | Shipping             |
...
</pre>

# FULL OUTER JOIN

SELECT e.last_name, d.department_id, d.department_name
FROM nikovits.employees e FULL OUTER JOIN nikovits.departments d
ON (e.department_id = d.department_id) ;

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | DEPARTMENT_ID        | DEPARTMENT_NAME      |
+----------------------+----------------------+----------------------+
| King                 | 90                   | Executive            |
| Kochhar              | 90                   | Executive            |
| De Haan              | 90                   | Executive            |
| Hunold               | 60                   | IT                   |
| Ernst                | 60                   | IT                   |
| Austin               | 60                   | IT                   |
| Pataballa            | 60                   | IT                   |
| Lorentz              | 60                   | IT                   |
| Greenberg            | 100                  | Finance              |
| Faviet               | 100                  | Finance              |
| Chen                 | 100                  | Finance              |
| Sciarra              | 100                  | Finance              |
| Urman                | 100                  | Finance              |
| Popp                 | 100                  | Finance              |
| Raphaely             | 30                   | Purchasing           |
| Khoo                 | 30                   | Purchasing           |
| Baida                | 30                   | Purchasing           |
| Tobias               | 30                   | Purchasing           |
| Himuro               | 30                   | Purchasing           |
| Colmenares           | 30                   | Purchasing           |
| Weiss                | 50                   | Shipping             |
| Fripp                | 50                   | Shipping             |
...
</pre>

<img src="image-16.png" alt="alt text" width="700" />

#

<img src="image-17.png" alt="alt text" width="700" />


# Creating Cross Joins

- The CROSS JOIN clause produces the crossproduct of two tables.
- This is also called a Cartesian product between the two tables.

SELECT last_name, department_name
FROM nikovits.employees
CROSS JOIN nikovits.departments ;

<pre>
+----------------------+----------------------+
| LAST_NAME            | DEPARTMENT_NAME      |
+----------------------+----------------------+
| King                 | Administration       |
| Kochhar              | Administration       |
| De Haan              | Administration       |
| Hunold               | Administration       |
| Ernst                | Administration       |
| Austin               | Administration       |
| Pataballa            | Administration       |
| Lorentz              | Administration       |
| Greenberg            | Administration       |
| Faviet               | Administration       |
| Chen                 | Administration       |
| Sciarra              | Administration       |
| Urman                | Administration       |
| Popp                 | Administration       |
| Raphaely             | Administration       |
| Khoo                 | Administration       |
| Baida                | Administration       |
| Tobias               | Administration       |
| Himuro               | Administration       |
| Colmenares           | Administration       |
| Weiss                | Administration       |
| Fripp                | Administration       |
...
</pre>

<img src="image-18.png" alt="alt text" width="700" />

#

<img src="image-19.png" alt="alt text" width="700" />

SELECT last_name
FROM nikovits.employees
WHERE salary >
(SELECT salary
FROM nikovits.employees
WHERE last_name = 'Abel');

<pre>
+----------------------+
| LAST_NAME            |
+----------------------+
| King                 |
| Kochhar              |
| De Haan              |
| Greenberg            |
| Russell              |
| Partners             |
| Errazuriz            |
| Ozer                 |
| Hartstein            |
| Higgins              |
+----------------------+
</pre>

# Guidelines for Using Subqueries

- Enclose subqueries in parentheses.
- Place subqueries on the right side of the comparison condition.
- The ORDER BY clause in the subquery is not needed unless you are performing Top-N analysis.
- Use single-row operators with single-row subqueries, and use multiple-row operators with multiple-row subqueries.

<img src="image-20.png" alt="alt text" width="700" />

#

<img src="image-21.png" alt="alt text" width="700" />

# Executing Single-Row Subqueries

SELECT last_name, job_id, salary
FROM nikovits.employees
WHERE job_id =
(SELECT job_id
FROM nikovits.employees
WHERE employee_id = 141)
AND salary >
(SELECT salary
FROM nikovits.employees
WHERE employee_id = 143);

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | JOB_ID               | SALARY               |
+----------------------+----------------------+----------------------+
| Nayer                | ST_CLERK             | 3200                 |
| Mikkilineni          | ST_CLERK             | 2700                 |
| Bissot               | ST_CLERK             | 3300                 |
| Atkinson             | ST_CLERK             | 2800                 |
| Mallin               | ST_CLERK             | 3300                 |
| Rogers               | ST_CLERK             | 2900                 |
| Ladwig               | ST_CLERK             | 3600                 |
| Stiles               | ST_CLERK             | 3200                 |
| Seo                  | ST_CLERK             | 2700                 |
| Rajs                 | ST_CLERK             | 3500                 |
| Davies               | ST_CLERK             | 3100                 |
+----------------------+----------------------+----------------------+
</pre>

# Using Group Functions in a Subquery

SELECT last_name, job_id, salary
FROM nikovits.employees
WHERE salary =
(SELECT MIN(salary)
FROM nikovits.employees);

<pre>
+----------------------+----------------------+----------------------+
| LAST_NAME            | JOB_ID               | SALARY               |
+----------------------+----------------------+----------------------+
| Olson                | ST_CLERK             | 2100                 |
+----------------------+----------------------+----------------------+
</pre>

<img src="image-22.png" alt="alt text" width="700" />

#

<img src="image-23.png" alt="alt text" width="700" />

#

<img src="image-24.png" alt="alt text" width="700" />

#

<img src="image-25.png" alt="alt text" width="700" />

# Using the ANY Operator in Multiple-Row Subqueries

SELECT employee_id, last_name, job_id, salary
FROM nikovits.employees
WHERE salary < ANY
(SELECT salary
FROM nikovits.employees
WHERE job_id = 'IT_PROG')
AND job_id <> 'IT_PROG';

<pre>
+----------------------+----------------------+----------------------+----------------------+
| EMPLOYEE_ID          | LAST_NAME            | JOB_ID               | SALARY               |
+----------------------+----------------------+----------------------+----------------------+
| 132                  | Olson                | ST_CLERK             | 2100                 |
| 136                  | Philtanker           | ST_CLERK             | 2200                 |
| 128                  | Markle               | ST_CLERK             | 2200                 |
| 135                  | Gee                  | ST_CLERK             | 2400                 |
| 127                  | Landry               | ST_CLERK             | 2400                 |
| 191                  | Perkins              | SH_CLERK             | 2500                 |
| 182                  | Sullivan             | SH_CLERK             | 2500                 |
| 144                  | Vargas               | ST_CLERK             | 2500                 |
| 140                  | Patel                | ST_CLERK             | 2500                 |
| 131                  | Marlow               | ST_CLERK             | 2500                 |
| 119                  | Colmenares           | PU_CLERK             | 2500                 |
| 118                  | Himuro               | PU_CLERK             | 2600                 |
| 198                  | OConnell             | SH_CLERK             | 2600                 |
| 199                  | Grant                | SH_CLERK             | 2600                 |
| 143                  | Matos                | ST_CLERK             | 2600                 |
| 126                  | Mikkilineni          | ST_CLERK             | 2700                 |
| 139                  | Seo                  | ST_CLERK             | 2700                 |
| 117                  | Tobias               | PU_CLERK             | 2800                 |
| 183                  | Geoni                | SH_CLERK             | 2800                 |
| 130                  | Atkinson             | ST_CLERK             | 2800                 |
| 195                  | Jones                | SH_CLERK             | 2800                 |
| 190                  | Gates                | SH_CLERK             | 2900                 |
...
</pre>

# Using the ALL Operator in Multiple-Row Subqueries

SELECT employee_id, last_name, job_id, salary
FROM nikovits.employees
WHERE salary < ALL
(SELECT salary
FROM nikovits.employees
WHERE job_id = 'IT_PROG')
AND job_id <> 'IT_PROG';

<pre>
+----------------------+----------------------+----------------------+----------------------+
| EMPLOYEE_ID          | LAST_NAME            | JOB_ID               | SALARY               |
+----------------------+----------------------+----------------------+----------------------+
| 185                  | Bull                 | SH_CLERK             | 4100                 |
| 192                  | Bell                 | SH_CLERK             | 4000                 |
| 193                  | Everett              | SH_CLERK             | 3900                 |
| 188                  | Chung                | SH_CLERK             | 3800                 |
| 137                  | Ladwig               | ST_CLERK             | 3600                 |
| 189                  | Dilly                | SH_CLERK             | 3600                 |
| 141                  | Rajs                 | ST_CLERK             | 3500                 |
| 186                  | Dellinger            | SH_CLERK             | 3400                 |
| 133                  | Mallin               | ST_CLERK             | 3300                 |
| 129                  | Bissot               | ST_CLERK             | 3300                 |
| 180                  | Taylor               | SH_CLERK             | 3200                 |
| 138                  | Stiles               | ST_CLERK             | 3200                 |
| 125                  | Nayer                | ST_CLERK             | 3200                 |
| 194                  | McCain               | SH_CLERK             | 3200                 |
| 115                  | Khoo                 | PU_CLERK             | 3100                 |
| 196                  | Walsh                | SH_CLERK             | 3100                 |
| 142                  | Davies               | ST_CLERK             | 3100                 |
| 181                  | Fleaur               | SH_CLERK             | 3100                 |
| 187                  | Cabrio               | SH_CLERK             | 3000                 |
| 197                  | Feeney               | SH_CLERK             | 3000                 |
| 116                  | Baida                | PU_CLERK             | 2900                 |
| 190                  | Gates                | SH_CLERK             | 2900                 |
...
</pre>

<img src="image-26.png" alt="alt text" width="700" />